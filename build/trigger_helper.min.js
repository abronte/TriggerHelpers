!function(){var Display,Event,Logger,Notification,Prefs,Request,isTrigger,root,_base,_base1,_nextTick,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;isTrigger=void 0!==window.forge,root=null!=(_ref=(_base="undefined"!=typeof exports&&null!==exports?exports:window).forge)?_ref:_base.forge={},root.isTrigger=function(){return isTrigger},_nextTick=function(func){return null!=func?setTimeout(func,1):void 0},Display=function(){function Display(){}var f,_i,_len,_ref1;for(_ref1=["forceLandscape","forcePortrait","allowAny"],_i=0,_len=_ref1.length;_len>_i;_i++)f=_ref1[_i],Display.prototype[f]=function(success){return"function"==typeof success?success():void 0};return Display}(),null==(_ref1=root.display)&&(root.display={}),null==(_ref2=(_base1=root.display).orientation)&&(_base1.orientation=new Display),Event=function(){function Event(){var namespace,_i,_len;for(_i=0,_len=ADD_LISTENERS.length;_len>_i;_i++)namespace=ADD_LISTENERS[_i],this[namespace]={addListener:function(){}}}var ADD_LISTENERS;return ADD_LISTENERS=["menuPressed","orientationChange","connectionStateChange","messagePushed","appPaused","appResumed"],Event}(),null==(_ref3=root.event)&&(root.event=new Event),Logger=function(){function Logger(){var level,methodName,name,_ref4;this.logLevel=5;for(name in LEVELS)_ref4=LEVELS[name],level=_ref4.level,methodName=_ref4.methodName,this[name]=function(msg){return this.logLevel>=level?console[null!=methodName?methodName:name](msg):void 0}}var LEVELS;return LEVELS={critical:{level:1,methodName:"error"},error:{level:2},info:{level:3},warning:{level:4,methodName:"info"},debug:{level:5}},Logger.prototype.level=function(level){return void 0!==level&&(this.logLevel=level),this.logLevel},Logger}(),null==(_ref4=root.logging)&&(root.logging=new Logger),Notification=function(){function Notification(){}return Notification.prototype.alert=function(title,text,success){var result;return(null==title||null==text)&&console.warn("Title and message text are required!"),result=confirm(""+title+"\n\n"+text),_nextTick(success)},Notification.prototype.create=Notification.prototype.alert,Notification.prototype.confirm=function(title,body,positive,negative,success){var result;return result=confirm(""+title+"\n\n"+body+"\n\n("+negative+"/"+positive+")"),_nextTick(function(){return"function"==typeof success?success(result):void 0})},Notification.prototype.toast=function(body,success){var style,toast;return style={position:"absolute",top:"10%","z-index":99,width:"33%","margin-left":"33%","text-align":"center",background:"#666",color:"#FFF",padding:"1em 0.4em","border-radius":"4px"},toast=$("<div>"+body+"</div>").css(style),$("body").prepend(toast),toast.fadeIn(200).delay(1e3).fadeOut(1e3,function(){return toast.remove()}),_nextTick(success)},Notification}(),null==(_ref5=root.notification)&&(root.notification=new Notification),Prefs=function(){function Prefs(){}return Prefs.prototype.get=function(key,callback){var _this=this;return _nextTick(function(){return"function"==typeof callback?callback(localStorage.getItem(_this._toForgeKey(key))):void 0})},Prefs.prototype.set=function(key,val,callback){return localStorage.setItem(this._toForgeKey(key),val),_nextTick(callback)},Prefs.prototype.keys=function(callback){var i,key,keys,_i,_ref6;for(keys=[],i=_i=0,_ref6=localStorage.length-1;_ref6>=0?_ref6>=_i:_i>=_ref6;i=_ref6>=0?++_i:--_i)key=localStorage.key(i),this._isForgeKey(key)&&keys.push(this._fromForgeKey(key));return _nextTick(function(){return callback(keys)})},Prefs.prototype.clear=function(key,callback){return localStorage.removeItem(this._toForgeKey(key)),_nextTick(callback)},Prefs.prototype.clearAll=function(callback){var _this=this;return forge.prefs.keys(function(keys){var key,_i,_len;for(_i=0,_len=keys.length;_len>_i;_i++)key=keys[_i],localStorage.removeItem(_this._toForgeKey(key));return _nextTick(callback)})},Prefs.prototype._toForgeKey=function(key){return"forge:"+key},Prefs.prototype._fromForgeKey=function(key){return key.replace(/^forge:/,"")},Prefs.prototype._isForgeKey=function(key){return key.match(/^forge:/)},Prefs}(),null==(_ref6=root.prefs)&&(root.prefs=new Prefs),Request=function(){function Request(){}return Request.prototype.get=function(url,callback){return $.ajax({type:"GET",url:url,dataType:"jsonp",processData:!1,success:callback})},Request.prototype.ajax=function(params){var oldError,_this=this;return oldError=params.error,null!=oldError&&(params.error=function(e){return oldError(_this._transformErrorArgument(e))}),$.ajax(params)},Request.prototype._transformErrorArgument=function(webError){return{message:webError.statusText,type:"EXPECTED_FAILURE",subtype:null,statusCode:""+webError.status,content:webError.responseText}},Request}(),null==(_ref7=root.request)&&(root.request=new Request)}.call(this);