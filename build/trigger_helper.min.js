!function(){var Logger,Notification,Prefs,Request,isTrigger,root,_base,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;isTrigger=void 0!==window.forge,root=null!=(_ref=(_base="undefined"!=typeof exports&&null!==exports?exports:window).forge)?_ref:_base.forge={},root.isTrigger=function(){return isTrigger},Logger=function(){function Logger(){var level,methodName,name,_ref1;this.logLevel=5;for(name in LEVELS)_ref1=LEVELS[name],level=_ref1.level,methodName=_ref1.methodName,this[name]=function(msg){return this.logLevel>=level?console[null!=methodName?methodName:name]("["+name.toUpperCase()+"] "+msg):void 0}}var LEVELS;return LEVELS={critical:{level:1,methodName:"error"},error:{level:2},info:{level:3},warning:{level:4,methodName:"info"},debug:{level:5}},Logger.prototype.level=function(level){return void 0!==level&&(this.logLevel=level),this.logLevel},Logger}(),null==(_ref1=root.logging)&&(root.logging=new Logger),Notification=function(){function Notification(){}return Notification.prototype.alert=function(title,text,success){var result;return(null==title||null==text)&&console.warn("Title and message text are required!"),result=confirm(""+title+"\n\n"+text),null!=success?setTimeout(success,1):void 0},Notification.prototype.create=Notification.prototype.alert,Notification.prototype.confirm=function(title,body,positive,negative,success){var result;return result=confirm(""+title+"\n\n"+body+"\n\n("+negative+"/"+positive+")"),null!=success?setTimeout(function(){return success(result)},1):void 0},Notification}(),null==(_ref2=root.notification)&&(root.notification=new Notification),Request=function(){function Request(){}return Request.prototype.get=function(url,callback){return $.ajax({type:"GET",url:url,dataType:"jsonp",processData:!1,success:callback})},Request.prototype.ajax=function(params){return $.ajax(params)},Request}(),null==(_ref3=root.request)&&(root.request=new Request),Prefs=function(){function Prefs(){}return Prefs.prototype.get=function(key,callback){var _this=this;return this._nextTick(function(){return"function"==typeof callback?callback(localStorage.getItem(_this._toForgeKey(key))):void 0})},Prefs.prototype.set=function(key,val,callback){return localStorage.setItem(this._toForgeKey(key),val),this._nextTick(callback)},Prefs.prototype.keys=function(callback){var i,key,keys,_i,_ref4;for(keys=[],i=_i=0,_ref4=localStorage.length-1;_ref4>=0?_ref4>=_i:_i>=_ref4;i=_ref4>=0?++_i:--_i)key=localStorage.key(i),this._isForgeKey(key)&&keys.push(this._fromForgeKey(key));return this._nextTick(function(){return callback(keys)})},Prefs.prototype.clear=function(key,callback){return localStorage.removeItem(this._toForgeKey(key)),this._nextTick(callback)},Prefs.prototype.clearAll=function(callback){var _this=this;return forge.prefs.keys(function(keys){var key,_i,_len;for(_i=0,_len=keys.length;_len>_i;_i++)key=keys[_i],localStorage.removeItem(_this._toForgeKey(key));return _this._nextTick(callback)})},Prefs.prototype._nextTick=function(cb){return null!=cb?setTimeout(cb,1):void 0},Prefs.prototype._toForgeKey=function(key){return"forge:"+key},Prefs.prototype._fromForgeKey=function(key){return key.replace(/^forge:/,"")},Prefs.prototype._isForgeKey=function(key){return key.match(/^forge:/)},Prefs}(),null==(_ref4=root.prefs)&&(root.prefs=new Prefs),Request=function(){function Request(){}return Request.prototype.get=function(url,callback){return $.ajax({type:"GET",url:url,dataType:"jsonp",processData:!1,success:callback})},Request.prototype.ajax=function(params){return $.ajax(params)},Request}(),null==(_ref5=root.request)&&(root.request=new Request)}.call(this);